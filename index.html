<html>
<head>
  <title>Demo Social Service</title>
  <link href="css/bootstrap.min.css" rel="stylesheet">
  <link id="siteicon" rel="icon" href="./firefox.png"/>
  <style>
  body {
    padding-top: 50px;
  }
  </style>
  <script src="https://code.jquery.com/jquery.js"></script>
  <script src="js/jquery.mustache.js"></script>
  <script src="js/bootstrap.min.js"></script>
  <script src="./directory.js" type="text/javascript"></script>
  <script>
    function pageSet() {
      var page = location.hash.split("/");
      var hash = page.shift();
      var name = page.shift();
      var target = $(hash ? hash : '#directory');
      if (hash == "#detail") {
        var manifest = manifests[name];
        var output = $("#provider-detail-template").mustache(manifest);
        $("#detail").html(output);
      }
      target.removeAttr('hidden');
      target.siblings().attr('hidden', 'true');
    }

    $(document).ready(function($) {
      $(window).bind( 'hashchange', function(e) {
        pageSet();
      });
      pageSet();
      //var output = $("#button-list").mustache(data);
      //$("#provider-list").html(output);
      var output = $("#provider-table-template").mustache(view);
      $("#provider-table").html(output);
    });

    function activateProvider(node, name) {
      var event = new CustomEvent("ActivateSocialFeature");
      node.setAttribute("data-service", JSON.stringify(manifests[name]));
      node.dispatchEvent(event);
    }
  </script>
</head>
<body>
  <div id="button-list" type="template" hidden="true">
    {{#manifests}}
    <button onclick="activateProvider(this, '{{key}}')" style="margin: 5px; padding: 5px 5px 5px 20px; background: url('{{iconURL}}') left center no-repeat;" title="Activate {{name}}">{{name}}</button>
    {{/manifests}}
  </div>

  <div id="provider-table-template" hidden="true">
    {{#data}}
    <div class="col-md-6" style="padding: 15px;">
      <div>
      <a class="btn btn-primary" href="#detail/{{key}}" role="button" style="float: right">View details &raquo;</a>
      <img src="{{icon64URL}}"></img>
      <span style="font-size: x-large; margin-left: 10px;"> {{name}}</span>
      </div>
      <p style="padding-top: 10px">{{description}}</p>
    </div>
    {{/data}}
  </div>

  <div id="provider-detail-template" hidden="true">
      <div class="container">
        <div class="item active">
        <img src="{{images.0}}" style="float: right"/>
        <h1><img src="{{icon64URL}}"/> {{name}}</h1>
        <h2>{{tagline}}</h2>              
        <p style="padding: 10px 0">{{description}}</p>
        <button type="button" class="btn btn-success" oncommand="activateProvider(this, '{{key}}')">Activate Now</button>
        <br/><a href="{{moreInfo}}">find out more...</a>
        </div>
      </div>
  </div>

  <div class="navbar navbar-inverse navbar-fixed-top" role="navigation">
    <div class="container">
      <div class="navbar-header">
        <button type="button" class="navbar-toggle" data-toggle="collapse" data-target=".navbar-collapse">
          <span class="sr-only">Toggle navigation</span>
          <span class="icon-bar"></span>
          <span class="icon-bar"></span>
          <span class="icon-bar"></span>
        </button>
        <a class="navbar-brand" href="/">SocialAPI</a>
      </div>
      <div class="collapse navbar-collapse">
        <ul class="nav navbar-nav">
          <li><a data-toggle="modal" data-target="#aboutModel">About</a></li>
          <li><a href="https://github.com/mixedpuppy/socialapi-demo">Github</a></li>
          <li><a href="https://developer.mozilla.org/en-US/docs/Social_API">Documentation</a></li>
        </ul>
      </div><!--/.nav-collapse -->
    </div>
  </div>
  
  <div class="modal fade" id="aboutModel" tabindex="-1" role="dialog" aria-labelledby="myModalLabel" aria-hidden="true">
    <div class="modal-dialog">
      <div class="modal-content">
        <div class="modal-header">
          <button type="button" class="close" data-dismiss="modal" aria-hidden="true">&times;</button>
          <h4 class="modal-title" id="myModalLabel">Firefox SocialAPI Integrations</h4>
        </div>
        <div class="modal-body">
          <p class="lead">SocialAPI is an architecture that allows simple 3rd party
        integrations into Firefox Browser using the web as the as the developer
        API. It supports specific vertical use cases centered around social
        interactions, but does not tightly constrain those use cases, allowing
        flexibility and creativity for 3rd parties. Specific features supported
        are notifications, share, bookmarking (or save-for-later), sidebars and
        communications (e.g. chat and video).</p>
          <p class="lead"><span style="font-style: italic; font-weight: bold">To
        install from this directory</span> you must modify the <span
        style="font-style: italic; font-weight: bold">social.directories</span>
        preference in Firefox to include the domain <span id="directory-domain"
        style="font-style: italic; font-weight: bold"></span>, you can do that in
        about:config.</p>
        
        </div>
      </div>
    </div>
  </div>

  <div class="content">
    <div id="directory">
      <div id="carousel-example-generic" class="carousel slide" data-ride="carousel">
        <ol class="carousel-indicators">
          <li data-target="#carousel-example-generic" data-slide-to="0" class="active"></li>
          <li data-target="#carousel-example-generic" data-slide-to="1"></li>
          <li data-target="#carousel-example-generic" data-slide-to="2"></li>
        </ol>
        <div class="carousel-inner">
          <div class="item active">
            <div class="item-inner" style="width: 600px; margin: 20px auto;">
              <img src="images/saavn-screen.png" style="float:right"></img>
              <img src="images/saavn-logo.jpg"></img>
              <h1>Music Feed</h1>
              <p>Discover fresh music and hear more of what you love.</p>              
              <button type="button" class="btn btn-success" oncommand="activateProvider(this, 'saavn')">Activate Now</button>
              <br/><a href="#detail/saavn">find out more...</a>
            </div>
          </div>
          <div class="item">
            <div class="item-inner" style="width: 600px; margin: 20px auto;">
              <img src="images/delicious.png" style="float: right"/>
              <h2><img src="https://delicious.com/favicon.ico"/> Delicious</h2>
              <p>Never lose a link again.</p>              
              <button type="button" class="btn btn-success" oncommand="activateProvider(this, 'delicious')">Activate Now</button>
              <br/><a href="#detail/delicious">find out more...</a>
            </div>
          </div>
          <div class="item">
            <div class="item-inner" style="width: 600px; margin: 20px auto;">
              <img src="images/facebook-share.png" style="float: right"></img>
              <img src="images/FB-f-Logo__blue_58.png"></img>
              <h2>Facebook Share Demo</h2>
              <p>Stay connected</p>
              <button type="button" class="btn btn-success" oncommand="activateProvider(this, 'facebook')">Activate Now</button>
              <br/><a href="#detail/facebook">find out more...</a>
            </div>
          </div>
        </div>
        <a class="left carousel-control" href="#carousel-example-generic" data-slide="prev">
          <span class="glyphicon glyphicon-chevron-left"></span>
        </a>
        <a class="right carousel-control" href="#carousel-example-generic" data-slide="next">
          <span class="glyphicon glyphicon-chevron-right"></span>
        </a>
      </div>
  
      <div class="container">
        <h3>More SocialAPI Demo Providers</h3>
        <p class="lead">These are useful as examples and UI testing. Many of
          these will not work in several ways. In most cases they are not provided
          by the website linked to.  Some of the demos use the mobile websites,
          you may need to install a <a
          href="https://addons.mozilla.org/en-US/firefox/addon/wmlbrowser/">WML
          extension for Firefox.</a> You should also read the <a data-toggle="modal"
          data-target="#aboutModel">instructions to use this site.</a></p>
  
        <div id="provider-table" class="row"></div>
        <div id="provider-list"></div>
      </div>
    </div>

    <div id="detail"></div>
  </div>
</body>
</html>
